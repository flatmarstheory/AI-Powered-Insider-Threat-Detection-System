# AI-Powered Insider Threat Detection System

## Overview
Detects insider threats using machine learning by analyzing user behavior, system access, and anomalies. Includes simulated logs, anomaly detection models, a combined dashboard, explainability tools, graph analysis, and red team simulation.

<img width="2429" height="1038" alt="image" src="https://github.com/user-attachments/assets/3222f4cc-304c-4d84-975e-c441531e8d7f" />

<img width="2416" height="1235" alt="image" src="https://github.com/user-attachments/assets/a10dd8bf-ecec-4ffd-b9b5-a7e7e963ced0" />


## Features
- Simulated and real log ingestion (user logins, file access, USB usage, emails)
- Feature engineering for behavioral, frequency, anomaly, graph, and NLP features
- Unsupervised anomaly detection (Isolation Forest, One-Class SVM, Autoencoder)
- Red team simulation to inject malicious behaviors
- Graph-based analysis (NetworkX, PyVis) for entity relationships and at-risk visualization
- Dashboard for anomaly review, user detail, interactive graph, and system explanation
- Explainability with SHAP (and LIME for compatible models)

## Setup
```bash
pip install -r requirements.txt
```

## Usage
- Run data simulation: `python data/simulate_logs.py`
- (Optional) Inject red team behaviors: `python data/simulate_red_team.py`
- Feature engineering: `python features/merge_features.py` (runs all feature scripts and merges)
- Train models: `python models/train.py`
- Launch dashboard: `streamlit run dashboard/combined_dashboard.py`

## Dashboard Tabs
- **Anomaly Table:** Sortable, filterable table of users, anomaly scores, and red team flags
- **User Detail:** Feature and anomaly breakdown for selected user
- **At-Risk Graph:** Interactive PyVis graph of high-risk users and their connections
- **How Does It Work?:** Detailed explanation of the system's mathematics, algorithms, and design

## Data
- Simulated logs (generated by scripts in `data/`)
- (Optional) CERT Insider Threat Dataset (integration not included by default)

## Advanced Features
- Graph-based features and visualization (NetworkX, PyVis)
- NLP features from email analysis
- Red team simulation for robust testing
- Explainability with SHAP (and LIME where supported)

## Stretch Goals
- Real-time stream processing (Kafka/Spark)
- Graph Neural Network for advanced entity analysis
- Further NLP for chat/message analysis

## Notes
- For legacy/simple dashboard, you may use `dashboard/app.py`, but `dashboard/combined_dashboard.py` is the recommended entry point for the full experience.
- All code is modular for easy extension and experimentation. 
